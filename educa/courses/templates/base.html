{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>{% block title %}Educa{% endblock %}</title>
    <link href="{% static 'css/base.css' %}" rel="stylesheet">
</head>
<body>
<div id="header">
    {% if request.user.is_authenticated %}
        <a href="{% url 'manage_course_list' %}" class="logo">Educa</a>
    {% else %}
        <a href="{% url 'login' %}" class="logo">Educa</a>
    {% endif %}
    <ul class="menu">
        {% if request.user.is_authenticated %}
            <li><a href="{% url 'logout' %}" id="logout-link">Sign out</a></li>
        {% else %}
            <li><a href="{% url 'login' %}">Sign in</a></li>
        {% endif %}
    </ul>
</div>

<div id="content">
    {% block content %}
    {% endblock %}
</div>
{% block include_js %}
{% endblock %}
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        // DOM`s model loaded
        {% block domready %}
            document.getElementById('logout-link').addEventListener('click', function (event) {
                event.preventDefault();
                var csrfToken = '{{ csrf_token }}';

                fetch("{% url 'logout' %}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'X-CSRFToken': csrfToken
                    }
                }).then(response => {
                    if (response.ok) {
                        window.location.href = '/'; // Перенаправляем на главную страницу после выхода
                    } else {
                        console.error('Logout failed');
                    }
                }).catch(error => {
                    console.error('Error:', error);
                });
            });
        {% endblock %}
    })
</script>
</body>
</html>